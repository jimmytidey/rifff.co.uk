package {	import fl.controls.TextInput;	import flash.events.*;	import flash.display.*;	import flash.text.TextField;	import fl.controls.Button;	import flash.media.SoundMixer;	import flash.media.SoundChannel;	public class Score extends MovieClip{		public var score:Array = new Array();				public function generate(jsonData, grid, soundContainer, number_of_steps, step_time) {								//declare the score array, with every step number for every bank option set to step, 0 offset			for (var bank_index:int =0; bank_index < grid.length; bank_index++) {				score[bank_index] = new Array() 							for (var bank_option_index:int =0; bank_option_index < grid[bank_index][0].length; bank_option_index++) {					score[bank_index][bank_option_index] = new Array();					//set the behaviour into the score array 					score[bank_index][bank_option_index]['loop'] = jsonData['banks'][bank_index]['bank_options'][bank_option_index]['loop'];					score[bank_index][bank_option_index]['overplay'] = jsonData['banks'][bank_index]['bank_options'][bank_option_index]['overplay'];															for (var step_number:int =0; step_number < number_of_steps; step_number++) {						score[bank_index][bank_option_index][step_number] = new Array();						if (grid[bank_index][step_number][bank_option_index] == 100) { 							grid[bank_index][step_number]['certain_play'] = bank_option_index;						}					}				}			}						//now set when the arrays should play 			for (bank_index=0; bank_index < grid.length; bank_index++) {				for (step_number=0; step_number < number_of_steps; step_number++) {														//if there is one step that is going to play, play it and stop everything else 					if(grid[bank_index][step_number]['certain_play'] != undefined) {												//get all the relevant stuff from jsondata						var certain_number = grid[bank_index][step_number]['certain_play'];						var file_location = jsonData['banks'][bank_index]['bank_options'][certain_number]['file_location'];						var file_location_array:Array = file_location.split(".");						var clean_file_location = file_location_array[0];												var loop = score[bank_index][certain_number]['loop'];						var overplay = score[bank_index][certain_number]['overplay'];												//set the certain to play step number to play						score[bank_index][certain_number][step_number]['action'] = "play";												//if overplay is not true, we need to put a stop in at the next step 						if (overplay != 'true') { 							score[bank_index][certain_number][step_number+1]['action'] = "stop";						}												//Seemless loop - if loop is set, and the next step has the same bank option playing, do not retrigger						if (loop == 'true') { 							if (grid[bank_index][step_number+1]['certain_play'] == certain_number) { 																score[bank_index][certain_number][step_number+1]['action'] == ""; 							}											}											}				}			}		}	}}